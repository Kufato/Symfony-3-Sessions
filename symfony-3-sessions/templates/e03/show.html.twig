{% extends 'base.html.twig' %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
    <div style="
        max-width:700px;
        margin:0 auto;
        background:#ffffff;
        border-radius:0.75rem;
        padding:2rem;
        box-shadow:0 4px 12px rgba(0,0,0,0.08);
    ">

        <h2>{{ post.title }}</h2>

        <small style="color:#555;">
            By {{ post.author.username }} ({{ post.author.reputation }})
            â€¢ {{ post.createdAt|date('d/m/Y H:i') }}
        </small>

        <p style="margin-top:1.5rem;">
            {{ post.content }}
        </p>

        {% if app.user %}
            {% set canLike = reputationService.canLike(app.user) %}
            {% set canDislike = reputationService.canDislike(app.user) %}
            {% set canEdit = reputationService.canEditPost(app.user, post) %}
        {% endif %}

        <div style="display:flex; gap:1rem; margin-top:1.5rem; flex-wrap:wrap;">

            <a
                {% if canLike %}
                    href="{{ path('e05_vote', { id: post.id, value: 1 }) }}"
                {% endif %}
                style="
                    background:#28a745;
                    color:#fff;
                    padding:0.5rem 1.2rem;
                    border-radius:0.5rem;
                    text-decoration:none;
                    opacity:{{ canLike ? '1' : '0.4' }};
                    pointer-events:{{ canLike ? 'auto' : 'none' }};
                "
                title="{{ canLike ? '' : 'Requires 3 reputation points' }}"
            >
                ğŸ‘ Like
            </a>

            <a
                {% if canDislike %}
                    href="{{ path('e05_vote', { id: post.id, value: -1 }) }}"
                {% endif %}
                style="
                    background:#dc3545;
                    color:#fff;
                    padding:0.5rem 1.2rem;
                    border-radius:0.5rem;
                    text-decoration:none;
                    opacity:{{ canDislike ? '1' : '0.4' }};
                    pointer-events:{{ canDislike ? 'auto' : 'none' }};
                "
                title="{{ canDislike ? '' : 'Requires 6 reputation points' }}"
            >
                ğŸ‘ Dislike
            </a>

            {% if canEdit %}
                <a href="{{ path('e06_edit', { id: post.id }) }}"
                style="
                    background:#ffc107;
                    color:#000;
                    padding:0.5rem 1.2rem;
                    border-radius:0.5rem;
                    text-decoration:none;
                ">
                    âœï¸ Edit
                </a>
            {% endif %}
        </div>

        {% if post.updatedAt %}
            <small style="display:block; margin-top:1.5rem; color:#666;">
                Last edited by {{ post.updatedBy.username }}
                on {{ post.updatedAt|date('d/m/Y H:i') }}
            </small>
        {% endif %}

        <a href="{{ path('e01_home') }}" style="
            display:inline-block;
            margin-top:2rem;
            background:#6c757d;
            color:#fff;
            padding:0.5rem 1.2rem;
            border-radius:0.5rem;
            text-decoration:none;
        ">
            â† Back
        </a>

    </div>
{% endblock %}